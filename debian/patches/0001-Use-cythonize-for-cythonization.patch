From: Pietro Battiston <me@pietrobattiston.it>
Date: Mon, 20 Jan 2014 11:16:00 +0100
Subject: Use "cythonize" for cythonization

---
 setup.py | 29 ++---------------------------
 1 file changed, 2 insertions(+), 27 deletions(-)

diff --git a/setup.py b/setup.py
index 413a474..6aba026 100755
--- a/setup.py
+++ b/setup.py
@@ -14,6 +14,7 @@ except ImportError:
 from distutils.cmd import Command
 from distutils.errors import CCompilerError, DistutilsExecError, \
     DistutilsPlatformError
+from Cython.Build import cythonize
 import errno
 import glob
 import os
@@ -177,33 +178,7 @@ elif sys.platform == 'win32':
 else:
     libraries = ['geos_c']
 
-if os.path.exists("MANIFEST.in"):
-    pyx_file = "shapely/speedups/_speedups.pyx"
-    c_file = "shapely/speedups/_speedups.c"
-
-    force_cython = False
-    if 'sdist' in sys.argv:
-        force_cython = True
-
-    try:
-        if (force_cython or not os.path.exists(c_file)
-                or os.path.getmtime(pyx_file) > os.path.getmtime(c_file)):
-            print("Updating C extension with Cython.", file=sys.stderr)
-            subprocess.check_call(["cython", "shapely/speedups/_speedups.pyx"])
-    except (subprocess.CalledProcessError, OSError):
-        print("Warning: Could not (re)create C extension with Cython.",
-              file=sys.stderr)
-        if force_cython:
-            raise
-    if not os.path.exists("shapely/speedups/_speedups.c"):
-        print("Warning: speedup extension not found", file=sys.stderr)
-
-ext_modules = [
-    Extension(
-        "shapely.speedups._speedups",
-        ["shapely/speedups/_speedups.c"],
-        libraries=libraries)
-]
+ext_modules = cythonize("shapely/speedups/_speedups.pyx")
 
 try:
     # try building with speedups
